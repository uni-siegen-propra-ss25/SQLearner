<h2 mat-dialog-title>Datenbank bearbeiten</h2>

<div class="dialog-content">
  <!-- SQL Query Form (only the SQL-Queries block is left) -->
  <form [formGroup]="queryForm" (ngSubmit)="executeQuery()">
    <mat-dialog-content>
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>SQL Query</mat-label>
        <textarea matInput 
                  formControlName="query" 
                  rows="8" 
                  placeholder="Enter your SQL query here..."
                  spellcheck="false"
                  class="sql-editor"></textarea>
        <mat-hint>Press Ctrl+Enter to execute query</mat-hint>
      </mat-form-field>

      <div class="query-actions">
        <button mat-raised-button 
                color="accent" 
                type="submit" 
                [disabled]="!queryForm.valid || isExecutingQuery"
                class="execute-button">
          <mat-icon>play_arrow</mat-icon>
          {{ isExecutingQuery ? 'Executing...' : 'Execute Query' }}
        </button>
        <button mat-button 
                type="button" 
                (click)="clearQueryResult()" 
                [disabled]="!queryResult"
                class="clear-button">
          <mat-icon>clear</mat-icon>
          Clear Results
        </button>
      </div>
    </mat-dialog-content>
    <!-- Query Results -->
    <div class="query-results" *ngIf="queryResult">
      <h4>Query Results</h4>
      <div class="result-table" *ngIf="queryResult.rows && queryResult.rows.length > 0">
        <table mat-table [dataSource]="queryResult.rows" class="mat-elevation-z2">
          <ng-container *ngFor="let column of queryResult.columns" [matColumnDef]="column">
            <th mat-header-cell *matHeaderCellDef>{{column}}</th>
            <td mat-cell *matCellDef="let row">{{row[column]}}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="queryResult.columns"></tr>
          <tr mat-row *matRowDef="let row; columns: queryResult.columns;"></tr>
        </table>
      </div>
      <div class="no-results" *ngIf="!queryResult.rows || queryResult.rows.length === 0">
        No results found
      </div>
      <div class="query-info" *ngIf="queryResult.rowCount !== undefined">
        <p>Affected rows: {{queryResult.rowCount}}</p>
      </div>
    </div>
  </form>
</div>
